!function(a){var b,c,d,e=null,f={},g=[],h=[],i=function(){if(g.length||h.length){var a=g.length?g[g.length-1]:h[h.length-1],i=d.width(),j=d.height(),k=f[a].config.height,l=k,m=f[a].config.width,n=0,o=!1,p=!1;if(f[a].body.css({height:""}),e&&b.addClass("has-fwpmanip-modal"),"string"==typeof m&&(m=parseInt(m),m=i/100*parseInt(m)),"string"==typeof k&&(k=parseInt(k),k=j/100*parseInt(k)),n=(j-k)/2.2,0>n&&(n=0),k+2*f[a].config.padding>j&&e&&(k=j,l="100%",e&&e.css({}),p=!0),m+2*f[a].config.padding>=i&&(m="100%",e&&e.css({}),p=!0),!0===p&&(700>=i&&i>600?(e&&(k=j-2*f[a].config.padding),m=i,l=k-2*f[a].config.padding,m="100%",n=0,e&&e.css({padding:f[a].config.padding})):600>=i&&(e&&(k=j),m=i,l="100%",n=0,e&&e.css({padding:0}))),e&&e.is(":hidden")&&(o=!0,e.show()),f[a].header&&(e&&e.show(),k-=f[a].header.outerHeight(),f[a].closer.css({padding:f[a].header.outerHeight()/2-3.8}),f[a].title.css({paddingRight:f[a].closer.outerWidth()})),f[a].footer&&(e&&e.show(),k-=f[a].footer.outerHeight()),e&&o===!0&&(e.hide(),o=!1),k!=l&&f[a].body.css({height:k}),f[a].modal.css({width:m}),f[a].config.sticky&&f[a].config.minimized){var q={},r=f[a].title.outerHeight()-f[a].modal.outerHeight();f[a].config.sticky.indexOf("bottom")>-1?q["margin-bottom"]=r:f[a].config.sticky.indexOf("top")>-1&&(q["margin-top"]=r),f[a].modal.css(q),f[a].config.sticky.length>=3&&(c.css("margin-"+f[a].config.sticky[0],f[a].title.outerHeight()),p?f[a].modal.css(f[a].config.sticky[1],0):f[a].modal.css(f[a].config.sticky[1],parseFloat(f[a].config.sticky[2])))}return e&&(e.fadeIn(f[a].config.speed),f[a].modal.css({top:"calc( 50% - "+f[a].modal.outerHeight()/2+"px)",left:"calc( 50% - "+f[a].modal.outerWidth()/2+"px)"}),setTimeout(function(){f[a].modal.addClass("fwpmanip-animate")},10)),f}},j=function(c){if(g.length)if(c?g.splice(c.indexOf(g),1):c=g.pop(),f[c].modal.hasClass("fwpmanip-animate")&&!g.length)f[c].modal.removeClass("fwpmanip-animate"),setTimeout(function(){var a=f[c];a.modal.fadeOut(200,function(){a.modal.remove()}),f[c].flush&&delete f[c]},500);else if(e){var d=f[c];d.modal.fadeOut(200,function(){d.modal.remove()}),f[c].flush&&delete f[c]}g.length?(f[g[g.length-1]].modal.find(".fwpmanip-modal-blocker").remove(),f[g[g.length-1]].modal.animate({opacity:1},100)):(e&&e.fadeOut(250,function(){a(this).remove(),e=null}),b.removeClass("has-fwpmanip-modal"),a(window).trigger("modals.closed")),a(window).trigger("modal.close")};a.fwpmanipModal=function(k,l){b=a("html"),c=a("body"),d=a(window);var m=a.extend(!0,{element:"form",height:550,width:620,padding:12,speed:250,content:""},k);m.trigger=l,e||m.sticky||(e=a("<div>",{"class":"fwpmanip-backdrop"}),c.append(e),e.hide());var n=m.element,o=m.modal;"undefined"==typeof f[o]?(m.sticky&&(m.sticky=m.sticky.split(" "),m.sticky.length<2&&(m.sticky=null),h.push(o)),f[o]={config:m},f[o].body=a("<div>",{"class":"fwpmanip-modal-body",id:o+"_fwpmanipModalBody"}),f[o].content=a("<div>",{"class":"fwpmanip-modal-content",id:o+"_fwpmanipModalContent"})):f[o].config=m;var p={id:o+"_fwpmanipModal",tabIndex:-1,"ariaLabelled-by":o+"_fwpmanipModalLable",method:"post",enctype:"multipart/form-data","class":"fwpmanip-modal-wrap "+(m.sticky?" fwpmanip-sticky-modal "+m.sticky[0]+"-"+m.sticky[1]:"")};if(k.config&&a.extend(p,k.config),f[o].modal=a("<"+n+">",p),m.sticky||g.push(o),m.animate&&e){var q=m.animate.split(" "),r=m.speed+"ms",s=m.animateEase?m.animateEase:"ease";1===q.length&&(q[1]=0),f[o].modal.css({transform:"translate("+q[0]+", "+q[1]+")","-web-kit-transition":"transform "+r+" "+s,"-moz-transition":"transform "+r+" "+s,transition:"transform "+r+" "+s})}if(f[o].content.css({}),f[o].body.append(f[o].content).appendTo(f[o].modal),e?e.append(f[o].modal):f[o].modal.appendTo(a("body")),m.footer){if(!f[o].footer)if(f[o].footer=a("<div>",{"class":"fwpmanip-modal-footer",id:o+"_fwpmanipModalFooter"}),f[o].footer.css({padding:m.padding}),"function"==typeof window[m.footer])f[o].footer.append(window[m.footer](m,f[o]));else if("string"==typeof m.footer)try{var t=a(m.footer);f[o].footer.html(t.html())}catch(u){f[o].footer.html(m.footer)}f[o].footer.appendTo(f[o].modal)}if(m.title){var v="prependTo";f[o].header=a("<div>",{"class":"fwpmanip-modal-title",id:o+"_fwpmanipModalTitle"}),f[o].closer=a("<a>",{href:"#close","class":"fwpmanip-modal-closer","data-dismiss":"modal","aria-hidden":"true",id:o+"_fwpmanipModalCloser"}).html("&times;"),f[o].title=a("<h3>",{"class":"modal-label",id:o+"_fwpmanipModalLable"}),f[o].title.html(m.title).appendTo(f[o].header),f[o].title.css({padding:m.padding}),f[o].title.append(f[o].closer),f[o].config.sticky?(f[o].config.minimized&&!0!==f[o].config.minimized&&(setTimeout(function(){f[o].title.trigger("click")},parseInt(f[o].config.minimized)),f[o].config.minimized=!1),f[o].closer.hide(),f[o].title.addClass("fwpmanip-modal-closer").data("modal",o).appendTo(f[o].header),f[o].config.sticky.indexOf("top")>-1&&(v="appendTo")):f[o].closer.data("modal",o).appendTo(f[o].header),f[o].header[v](f[o].modal)}if(f[o].modal.outerWidth(m.width),m.content&&!f[o].content.children().length){if("function"==typeof m.content)f[o].content.append(m.content(m,f[o]));else if("string"==typeof m.content)if("function"==typeof window[m.content])f[o].content.html(window[m.content](m));else try{var w=a(m.content);if(!w.length)throw new Error;f[o].content.append(w.html()),w.show(),f[o].modal.removeClass("processing")}catch(u){f[o].footer.hide(),setTimeout(function(){f[o].modal.addClass("processing"),a.post(m.content,l.data(),function(a){f[o].content.html(a),f[o].modal.removeClass("processing"),f[o].footer.show()})},250)}}else f[o].modal.removeClass("processing");g.length>1&&g[g.length-2]!==o&&(f[g[g.length-2]].modal.prepend('<div class="fwpmanip-modal-blocker"></div>').animate({opacity:1},100),f[o].modal.hide().fadeIn(200)),i(),a(window).trigger("modal.open"),k.master&&g&&delete f[g.shift()],f[o].positionModals=i,f[o].closeModal=function(){j(o)};var x=f[o].modal.find('button[type="submit"]');x.length?f[o].flush=!0:f[o].modal.find("input").on("change",function(){f[o].modal.submit()});var y=a('<div class="notice error"></div>'),z=a("<p></p>"),A=a('<button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button>');return z.appendTo(y),A.appendTo(y),A.on("click",function(){y.animate({height:0},100,function(){y.css("height",""),z.html(),y.detach()})}),f[o].modal.attr("data-load-element","_parent").baldrick({request:window.location.href,before:function(b,c){a(document).trigger("fwpmanip.itemsubmit"),x=f[o].modal.find('button[type="submit"]'),x.length&&(x.prop("disabled",!0),f[o].modal.addClass("processing")),y.detach()},callback:function(a){if(a.params.trigger.find('[type="submit"],button').prop("disabled",!1),f[o].modal.removeClass("processing"),f[o].data=a.rawData.data,"object"==typeof a.rawData)if(a.rawData.success)"string"==typeof a.rawData.data?a.rawData=a.rawData.data:"object"==typeof a.rawData.data?(a.rawData.data.redirect&&(window.location=a.rawData.data.redirect),f[o].modal.trigger("modal.complete")):"boolean"==typeof a.rawData.data&&a.rawData.data===!0&&x.length&&(f[o].flush=!1),j();else if(a.params.target=!1,"string"==typeof a.rawData.data){z.html(a.rawData.data),y.appendTo(f[o].body);var b=y.height();y.height(0).animate({height:b},100)}else j();else j()},complete:function(){a(document).trigger("fwpmanip.init")}}),f[o]},a.fn.fwpmanipModal=function(b){return b||(b={}),b=a.extend({},this.data(),b),a.fwpmanipModal(b,this)},window.addEventListener?(window.addEventListener("resize",i,!1),window.addEventListener("keypress",function(a){27===a.keyCode&&null!==e&&e.trigger("click")},!1)):window.attachEvent?window.attachEvent("onresize",i):window.onresize=i,a(document).on("click","[data-modal]:not(.fwpmanip-modal-closer)",function(b){return b.preventDefault(),a(this).fwpmanipModal()}),a(document).on("click",".fwpmanip-modal-closer",function(b){b.preventDefault(),a(window).trigger("close.modal")}),a(window).on("close.modal",function(a){j()}),a(window).on("modal.init",function(b){a("[data-modal][data-autoload]").each(function(){a(this).fwpmanipModal()})}),a(window).on("modal.open",function(b){a(document).trigger("fwpmanip.init")}),a(window).load(function(){a(window).trigger("modal.init")})}(jQuery);